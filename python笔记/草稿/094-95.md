1.  数据库修改，先在cache中进行修改，定期进行修改(如：每秒钟进行写入硬盘)
2.  index入口页面

## Hbuilder X

-   onclick表示鼠标点击事件
-   tap：表示点击事件
-   release用来结束hold事件

### html的代码块

```css
mdo：构建初始页面，选择css和js，mdocument
mhe：标题栏
mbo：主体，所有代码需要写进此块中
msl：轮播图
mg：九宫格
mli：图文列表
mta：底部选项卡
minput：input框
```

### js代码块

```css
funn：创建函数
fori：for循环
maj：ajax
mpost：ajax，post请求
mget：ajax，get请求
dga：
```

```js
mui.init();		// 初始化页面参数
mpr				// 初始化h5+
ming			// 初始化手势配置
dga				// 绑定事件，document get by id addEvent
mdt				// 消失的窗口，mtoast
```

-   调用摄像头
-   _doc/camera/：如果没有 / 则代表是文件，会覆盖；当前应用的私有目录

```js
document.getElementById('open').addEventListener('tap', function() {
    mui.toast('open...');
    var cmr = plus.camera.getCamera(1);    // 获得摄像头对象
    res = cmr.supportedImageResolutions[0];// 获得支持的图片分辨率
    fmt = cmr.supportedImageFormats[0];	   // 获得支持的图片格式
    // 调用摄像头
    cmr.captureImage(
        function(s) {
            console.log(JSON.stringify(s));
            console.log('拍照成功');
   		 },
        function(err) {
        	console.log('拍照失败');
    	},
        {
            resolution: res,
            format: fmt
    	})
});
```

### 调用H5+

```js
mui.plusReady(function () {})				// h5+ 加载事件，和h5相关的js操作需要使用
mui.back();									// 返回上一级
document.getElementById('open').addEventListener(tap);
```

```js
// 注册，login页面
1. 创建 html
2. mdo
3. mhe // 带返回箭头的
6. 使用ui组件
7. 给注册按钮绑定事件
```

```js
// index页面
4. 为设置绑定事件(mdt检测事件是否绑定成功)
5. mop	// 打开新页面
```

```js
// 创建reg页面
8. mhe
9. mbo
10.返回按钮：class=mui-action-back
11.注册按钮绑定事件
12.校验密码
13.使用ajax提交post请求，数据提交给Flask
14.mui.ajax/mui.get()/mui.post()
15.mba：返回上一级
16.密码md5加密
17.plus打开系统相册，gallery，uploader
18.使用uploader对象上传文件
```

### 创建Flask API

```python
login
register
```



## 创建userinfo页面

```js
// 返回页面是否有更改后的值
mopen
1. extras
2. styles:{需要bottom，必须有top}
```

```html
<div style="text-align:center">
	<img srt="" style="border-radius:50%; width:200px; height:200px">
</div>
```

```js
// 获取当前页面所有数据
var data = plus.webview.currentWebview();
```

```js
mui.back = function(){
    mui.toast('msg')
}
```

```js
// 类似 session/cookies，只能存储字符串类型
Storage
```

## webview

-   主页和首页进行分开加载

```js
加载子页面
入口也不好控制，尽量分开
```

-   存储公共变量：存储url

```js
// js文件
window.serv = "http://192.168.12.4:9527"
window.serv_icon = window.server + '/get_icon/';
```

-   获取其他页面数据

```js
// object类型
var user_info_webview = plus.webview.getWebviewByiId('user_info');
mui.toast(user_info_webview.username);
// 自定义事件：跨页面调度
// 向目标的webview发送指令
mui.fire()
// 获取传递的数据
console.log(eventData.detail)
```

-   使用app录音，将录音发送给web，web收到录音播放

```js
app录音
1. 按住：hold事件和其他事件冲突
2. 按住说话
3. 松开
4. 保存录音
5. 将录音发送 "$出去"，
	uploader发送录音 格式amr
	返回值 t(改动后的uploader对象)，status(http状态码)

将录音发送给web(websocket，js)
1. 

web收到录音播放
1. 收到字符串{sender, receiver, data}
2. 通过Flask中的send_file实现audio src 网络路径 播放语音文件


```







