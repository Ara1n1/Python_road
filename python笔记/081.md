## 1. 校验器

```python
def validate_title(value):
  	if 'xx' in value:
      	raise serializers.ValitdatoinError
    return value
```

2. 局部校验

```python
def validate_title(self, value):
  	if 'xx' in value:
      	raise serializers.ValitdatoinError
    return value
```

- 全局校验

```python
# attrs为有序字典，所有数据
def validate(self, attrs):
    pass
```

- 自定义校验

```python
# 类似于Form组建中的自定义校验规则
title = serializers.CharField(max_length=32, validators=[my_validata, ])

def my_validata(value)
    pass
```

## 2. ModelSerializer

```python
class BookSerializer(serializers.ModelSerializer):
  	pub_info = serializers.SerializersMethodField(read_only=True)
    author_info = serializers.SerializersMethodField(read_only=True)
    
    def get_pub_info(self, obj):
      	return PublisherSerializer(obj.pub).data
      
    def get_pub_info(self, obj):
        return AuthorSerializer(obj.authors.all(), many=True).data
    
  	class Meta:
      	model = models.Book
        fields = '__all__'
        # 取值深度
        # depth = 1
        extra_kwargs = {
          	'pub':{'write_only':True},
          	'authors':{'write_only':True},
         }
```

## 1. 验证码

1. 设计login的url，使用CBV
2.  短信登录和密码登录分开
3. 极验—登录验证—技术文档
4. 下载：reqeusts、aliyun-python-sdk

```js
phone_num = $('#phone').val()
flag = /^1(3-9)[0-19]{9}$/.test(phone)
if (!flag){
  	return
}
...
```

- 发送手机验证码(aliyun)

```python
签名--模版--
```

5. 极验验证流程

![geetest_justify](/System/Volumes/Data/Users/henry/Documents/截图/Py截图/geetest_justify.jpg)

6. 

