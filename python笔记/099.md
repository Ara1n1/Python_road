## redis存储未读消息

```python
# redis放置在内网中
{
    k:"{}"
}
k:当前收消息方
{}: 
{
    'send1':1,   # 读取一次，清空即 0 
    'send2':2,
}
```

```python
from redis import Redis
RDB = Redis(host='127.0.0.1', port=6379)
# 设置未读消息
def set_msg(sender, receiver):
    1. 当前没有receiver的数据，创建receiver字典
    msg_count = RDB.get(receiver)
    if msg_count:
        2. 当receiver收到 sender 消息，对应 sender + 1
        msg_dit = json.loads(msg_count)
        if msg_dit.get(sender):
           	msg_dit[sender] += 1
#        else:
#            msg_dit[sender] = 1
#        msg_count = json.dumps(msg_dit)
#     else:
#        msg_count = json.dumps({sender:1}) 
     msg_count = msg_dit.setdefault(sender,1)
     RDB.set(receiver, json.dumps(msg_count)) 

# 获取未读消息
def get_msg(sender, receiver):
    msg_count = RDB.get(receiver)
    if msg_count:
        msg_dict = json.loads(msg_count)
        count = msg_dict.get(sender, 0)
        msg_dict[sender] = 0
    else:
        count = 0
        msg_dict = {sender:0}
    RDB.set(receiver, json.dumps(msg_dict))
    return count
```



```python
# 点播歌曲
def my_nlp_lowB(Q, toy_id):
    # 理解 Q 的意图
    # 1. 点播歌曲
    # 2. 主动发起聊天
    
    # 3. 
```









